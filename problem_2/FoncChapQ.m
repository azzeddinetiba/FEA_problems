function [phi,grad] = FoncChapQ(k,Xgauss)
%Shape function in erference element
%        N3=(-1,1)     N4=(1,1)
%                _ _ _ _
%               |       |
%               |       |
%               |       |
%               | TR    | 
%               |_ _ _ _|
%        N1=(-1,-1)      (1,-1)=N2

%
s = Xgauss(:,1); 
t = Xgauss(:,2); 
if k == 1  %Q1
        phi   = [(1/4)*(-s-t+s.*t+1),(1/4)*(s-t-s.*t+1),(1/4)*(s+t+s.*t+1),(1/4)*(-s+t-s.*t+1)]; 
        grad  = [(1/4)*(-1+t) (1/4)*(1-t) (1/4)*(1+t) (1/4)*(-1-t);(1/4)*(-1+s) (1/4)*(-1-s) (1/4)*(1+s) (1/4)*(1-s)];
     
        
        
%          N7=(-1,1)   N8     N9=(1,1)
%                _ _ _ _ _ _
%               |           |
%               |           |
%           N4  |     N5    | N6
%               |           | 
%               |_ _ _ _ _ _|
%        N1=(-1,-1)  N2   (1,-1)=N3
elseif k==2 %Q2
    phi=[0.25*(s.^2).*(t.^2)-0.25*(s.^2).*(t)-0.25*(s).*(t.^2)+0.25*(s).*(t),...
        0.5*(t.^2)-0.5*(s.^2).*(t.^2)+0.5*(s.^2).*(t)-0.5*t,...
        0.25*(s.^2).*(t.^2)-0.25*(s.^2).*(t)+0.25*(s).*(t.^2)-0.25*(s).*(t),...
        0.5*(s.^2)-0.5*(s.^2).*(t.^2)+0.5*(s).*(t.^2)-0.5*s,...
        -(s.^2)-(t.^2)+(s.^2).*(t.^2)+1,...
        0.5*(s.^2)-0.5*(s.^2).*(t.^2)-0.5*(s).*(t.^2)+0.5*s,...
        0.25*(s.^2).*(t.^2)+0.25*(s.^2).*(t)-0.25*(s).*(t.^2)-0.25*(s).*(t),...
        0.5*(t.^2)-0.5*(s.^2).*(t.^2)-0.5*(s.^2).*(t)+0.5*t,...
        0.25*(s.^2).*(t.^2)+0.25*(s.^2).*(t)+0.25*(s).*(t.^2)+0.25*(s).*(t)];
    
    grad=[0.5*(s).*(t.^2)-0.5*(s).*(t)-0.25*(t.^2)+0.25*t,...
        -(s).*(t.^2)+s.*t,...
        0.5*(s).*(t.^2)-0.5*s.*t+(0.25)*(t.^2)-0.25*t,...
        s-(s).*(t.^2)+0.5*(t.^2)-0.5,...
        -2*s+2*(s).*(t.^2),...
        s-(s).*(t.^2)-0.5*(t.^2)+0.5,...
        0.5*(s).*(t.^2)+0.5*(s).*(t)-0.25*(t.^2)-0.25*t,...
        -(s).*(t.^2)-s.*t,...
        0.5*(s).*(t.^2)+0.5*t.*s+0.25*(t.^2)+0.25*t;...
        0.5*(s.^2).*(t)-0.25*(s.^2)-0.5*(s).*(t)+0.25*s,...
        t-(s.^2).*t+0.5*(s.^2)-0.5,...
        0.5*(s.^2).*(t)-0.25*(s.^2)+0.5*(s).*(t)-0.25*s,...
        -(s.^2).*(t)+(s).*(t),...
        -2*t+2*(s.^2).*(t),...
        -(s.^2).*(t)-(s).*(t),...
        0.5*(s.^2).*(t)+0.25*(s.^2)-0.5*(s).*(t)-0.25*s,...
        t-(s.^2).*(t)-0.5*(s.^2)+0.5,...
        0.5*(s.^2).*(t)+0.25*(s.^2)+0.5*(s).*(t)+0.25*s];
end

